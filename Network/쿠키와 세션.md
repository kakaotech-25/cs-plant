# 쿠키와 세션

## 1. 쿠카와 세션 사용 이유
### HTTP 프로토콜의 특성 및 약점
- **Connectionless(비연결지향)**: 클라이언트와 서버 간의 요청 및 응답 후 즉시 종료
- **Stateless(무상태성)**: 각 HTTP 요청은 독립적이며 서버는 이전 요청을 기억하지 않음
 
위와 같은 특성으로 웹 애플리케이션에서 사용자와의 상태를 유지하기 위해 **쿠키와 세션**과 같은 기술이 추가적으로 필요

## 2. 쿠키(Cookie)
- 사이트 접속 시 생성되는 정보를 4KB 이하의 크기의 임시 파일
- 클라이언트에 정보 저장 -> 보안에 취약
- 클라이언트와 서버 간의 데이터를 교환할 때 사용
- 웹사이트는 쿠키를 통해 사용자의 상태 정보를 유지 및 사용자 식별 가능
- 'key-value' 형식 사용

### 쿠키의 종류
- **지속 쿠키(Persistent Cookie)**: 만료 시간이 설정된 쿠키, 만료 시간이 될 때까지 브라우저가 종료되어도 클라이언트에 유지
- **세션 쿠키(Session Cookie)**: 만료 시간이 설정되지 않은 쿠키, 브라우저 메모리에 저장하고 브라우저가 종료될 때 삭제

### 용도
- **세션 관리**: 로그인, 장바구니 등의 상태를 유지하기 위해 사용
- **개인화**: 사용자에게 맞춤 페이지 제공 (ex)사용자가 선택한 언어 등 저장 -> 다른 페이지에도 적용)
- **트래킹**: 사용자의 웹사이트 방문 기록 및 패턴 추적

### 전송 방식
1. 클라이언트(웹 브라우저)가 웹 서버에 페이지 요청 시 웹 서버에서 쿠키 생성 및 HTTP 헤더에 쿠키를 담아 응답
2. 클라이언트는 응답을 받으면 쿠키 저장소에 쿠키를 저장
3. 다시 서버에 같은 요청을 보낼 시 HTTP 헤더에 쿠키를 담아 함께 전송 -> 웹 서버에서 쿠키를 업데이트하여 다시 응답
   

## 3. 세션(Session)
- 클라이언트가 서버에 접속할 때 서버측에서 생성되는 일종의 저장공간 
- 서버에서 클라이언트를 구분하기 위해 세션 ID를 부여
- 서버에 정보 저장
- 웹 서버에서만 접근이 가능 → 쿠키보다 비교적 안전
- 웹 브라우저마다 별도로 생성
- 브라우저 종료 전까지 유지, 다른 페이지에 정보 공유 O
- 다른 브라우저랑 공유 X

### 용도
- **보안상 중요한 작업 수행**: 로그인과 같이 보안상 중요한 작업 수행 (ex)서버에서 사용자가 로그인 여부 및 권한 추적 가능)

### **전송 방식**
1. 클라이언트가 웹 서버에 페이지 요청
2. 웹 서버에서 세션 ID 발급 후 쿠키에 담아 클라이언트에게 응답
3. 클라이언트는 해당 쿠키를 쿠키 저장소에 저장 -> 세션 ID가 담겨있는 쿠키를 다시 서버에 요청 시 서버에서 세션 ID를 확인하여 해당 세션 정보 확인
  
---
<table border="1" cellpadding="10" cellspacing="0">
    <thead>
        <tr>
            <th>\</th>
            <th>쿠키</th>
            <th>세션</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>저장 위치</strong></td>
            <td>클라이언트(브라우저)에 저장</td>
            <td>서버에 저장 및 관리</td>
        </tr>
        <tr>
            <td><strong>보안</strong></td>
            <td>클라이언트에 저장 -> 보안에 취약</td>
            <td>서버에 저장 -> 비교적 안전</td>
        </tr>
        <tr>
            <td><strong>수명 관리</strong></td>
            <td>설정된 만료 시간까지 유지</td>
            <td>브라우저 종료 전까지 유지</td>
        </tr>
        <tr>
            <td><strong>데이터 저장 용량</strong></td>
            <td>4KB로 제한</td>
            <td>쿠키보다 큰 데이터 저장 가능</td>
        </tr>
        <tr>
            <td><strong>속도</strong></td>
            <td>비교적 빠름</td>
            <td>비교적 느림</td>
        </tr>
    </tbody>
</table>
